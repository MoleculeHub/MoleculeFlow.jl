<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Similarity · MoleculeFlow.jl</title><meta name="title" content="Similarity · MoleculeFlow.jl"/><meta property="og:title" content="Similarity · MoleculeFlow.jl"/><meta property="twitter:title" content="Similarity · MoleculeFlow.jl"/><meta name="description" content="Documentation for MoleculeFlow.jl."/><meta property="og:description" content="Documentation for MoleculeFlow.jl."/><meta property="twitter:description" content="Documentation for MoleculeFlow.jl."/><meta property="og:url" content="https://moleculehub.github.io/MoleculeFlow.jl/api/similarity/"/><meta property="twitter:url" content="https://moleculehub.github.io/MoleculeFlow.jl/api/similarity/"/><link rel="canonical" href="https://moleculehub.github.io/MoleculeFlow.jl/api/similarity/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="MoleculeFlow.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MoleculeFlow.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../../examples/">Practical Examples</a></li><li><a class="tocitem" href="../../for-developers/">For Developers</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../io/">Basic I/O</a></li><li><a class="tocitem" href="../operations/">Molecular Operations</a></li><li><a class="tocitem" href="../reactions/">Chemical Reactions</a></li><li><a class="tocitem" href="../drawing/">Drawing &amp; Visualization</a></li><li><a class="tocitem" href="../descriptors/">Molecular Descriptors</a></li><li><a class="tocitem" href="../fingerprints/">Fingerprints</a></li><li><a class="tocitem" href="../pharmacophore/">Pharmacophore Features</a></li><li><a class="tocitem" href="../substructure/">Substructure Search</a></li><li><a class="tocitem" href="../atoms/">Atom Operations</a></li><li><a class="tocitem" href="../bonds/">Bond Operations</a></li><li class="is-active"><a class="tocitem" href>Similarity</a><ul class="internal"><li><a class="tocitem" href="#Tanimoto-Similarity"><span>Tanimoto Similarity</span></a></li><li><a class="tocitem" href="#Dice-Similarity"><span>Dice Similarity</span></a></li><li><a class="tocitem" href="#Cosine-Similarity"><span>Cosine Similarity</span></a></li><li><a class="tocitem" href="#Sokal-Similarity"><span>Sokal Similarity</span></a></li><li><a class="tocitem" href="#Bulk-Similarity"><span>Bulk Similarity</span></a></li><li><a class="tocitem" href="#Similarity-Matrix"><span>Similarity Matrix</span></a></li></ul></li><li><a class="tocitem" href="../standardization/">Standardization</a></li><li><a class="tocitem" href="../conformers/">Conformers</a></li><li><a class="tocitem" href="../alignment/">Alignment</a></li><li><a class="tocitem" href="../fragmentation/">Fragmentation</a></li><li><a class="tocitem" href="../graph/">Graph Operations</a></li><li><a class="tocitem" href="../progress/">Progress Tracking</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Similarity</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Similarity</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MoleculeHub/MoleculeFlow.jl/blob/main/docs/src/api/similarity.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Similarity-Analysis"><a class="docs-heading-anchor" href="#Similarity-Analysis">Similarity Analysis</a><a id="Similarity-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Similarity-Analysis" title="Permalink"></a></h1><p>Functions for calculating molecular similarity using various metrics.</p><h2 id="Tanimoto-Similarity"><a class="docs-heading-anchor" href="#Tanimoto-Similarity">Tanimoto Similarity</a><a id="Tanimoto-Similarity-1"></a><a class="docs-heading-anchor-permalink" href="#Tanimoto-Similarity" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MoleculeFlow.tanimoto_similarity" href="#MoleculeFlow.tanimoto_similarity"><code>MoleculeFlow.tanimoto_similarity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tanimoto_similarity(fp1::Vector{Bool}, fp2::Vector{Bool})
tanimoto_similarity(mol1::Molecule, mol2::Molecule; fingerprint_type=:morgan, kwargs...)</code></pre><p>Calculate the Tanimoto similarity coefficient between two molecules or fingerprints.</p><p>The Tanimoto coefficient is defined as the size of the intersection divided by the size of the union of two sets. For fingerprints, this translates to the number of bits set in both fingerprints divided by the number of bits set in either fingerprint.</p><p><strong>Arguments</strong></p><ul><li><code>fp1</code>, <code>fp2</code>: Boolean vectors representing molecular fingerprints</li><li><code>mol1</code>, <code>mol2</code>: Molecule objects to compare</li><li><code>fingerprint_type</code>: Type of fingerprint to use (<code>:morgan</code>, <code>:rdk</code>, <code>:maccs</code>, <code>:atom_pair</code>, <code>:topological_torsion</code>)</li><li><code>kwargs...</code>: Additional arguments passed to fingerprint generation functions</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Similarity score between 0.0 (no similarity) and 1.0 (identical)</li><li><code>missing</code>: If either molecule is invalid</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">mol1 = mol_from_smiles(&quot;CCO&quot;)
mol2 = mol_from_smiles(&quot;CCC&quot;)
similarity = tanimoto_similarity(mol1, mol2)  # Using Morgan fingerprints by default
similarity_rdk = tanimoto_similarity(mol1, mol2; fingerprint_type = :rdk)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MoleculeHub/MoleculeFlow.jl/blob/6d1329054751744243576b61d91035a6840182d7/src/molecule/similarity.jl#L5-L34">source</a></section></article><h2 id="Dice-Similarity"><a class="docs-heading-anchor" href="#Dice-Similarity">Dice Similarity</a><a id="Dice-Similarity-1"></a><a class="docs-heading-anchor-permalink" href="#Dice-Similarity" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MoleculeFlow.dice_similarity" href="#MoleculeFlow.dice_similarity"><code>MoleculeFlow.dice_similarity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dice_similarity(fp1::Vector{Bool}, fp2::Vector{Bool})
dice_similarity(mol1::Molecule, mol2::Molecule; fingerprint_type=:morgan, kwargs...)</code></pre><p>Calculate the Dice similarity coefficient (also known as Sørensen-Dice coefficient) between two molecules or fingerprints.</p><p>The Dice coefficient is defined as twice the size of the intersection divided by the sum of the sizes of the two sets. For fingerprints, this translates to 2 × (number of bits set in both) / (total bits set in both fingerprints).</p><p><strong>Arguments</strong></p><ul><li><code>fp1</code>, <code>fp2</code>: Boolean vectors representing molecular fingerprints</li><li><code>mol1</code>, <code>mol2</code>: Molecule objects to compare</li><li><code>fingerprint_type</code>: Type of fingerprint to use (<code>:morgan</code>, <code>:rdk</code>, <code>:maccs</code>, <code>:atom_pair</code>, <code>:topological_torsion</code>)</li><li><code>kwargs...</code>: Additional arguments passed to fingerprint generation functions</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Similarity score between 0.0 (no similarity) and 1.0 (identical)</li><li><code>missing</code>: If either molecule is invalid</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">mol1 = mol_from_smiles(&quot;CCO&quot;)
mol2 = mol_from_smiles(&quot;CCC&quot;)
similarity = dice_similarity(mol1, mol2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MoleculeHub/MoleculeFlow.jl/blob/6d1329054751744243576b61d91035a6840182d7/src/molecule/similarity.jl#L75-L103">source</a></section></article><h2 id="Cosine-Similarity"><a class="docs-heading-anchor" href="#Cosine-Similarity">Cosine Similarity</a><a id="Cosine-Similarity-1"></a><a class="docs-heading-anchor-permalink" href="#Cosine-Similarity" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MoleculeFlow.cosine_similarity" href="#MoleculeFlow.cosine_similarity"><code>MoleculeFlow.cosine_similarity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cosine_similarity(fp1::Vector{Bool}, fp2::Vector{Bool})
cosine_similarity(mol1::Molecule, mol2::Molecule; fingerprint_type=:morgan, kwargs...)</code></pre><p>Calculate the cosine similarity between two molecules or fingerprints.</p><p>The cosine similarity measures the cosine of the angle between two vectors in a multi-dimensional space. For binary fingerprints, this is computed as the dot product divided by the product of the magnitudes.</p><p><strong>Arguments</strong></p><ul><li><code>fp1</code>, <code>fp2</code>: Boolean vectors representing molecular fingerprints</li><li><code>mol1</code>, <code>mol2</code>: Molecule objects to compare</li><li><code>fingerprint_type</code>: Type of fingerprint to use (<code>:morgan</code>, <code>:rdk</code>, <code>:maccs</code>)</li><li><code>kwargs...</code>: Additional arguments passed to fingerprint generation functions</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Similarity score between 0.0 (orthogonal) and 1.0 (identical direction)</li><li><code>missing</code>: If either molecule is invalid</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">mol1 = mol_from_smiles(&quot;CCO&quot;)
mol2 = mol_from_smiles(&quot;CCC&quot;)
similarity = cosine_similarity(mol1, mol2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MoleculeHub/MoleculeFlow.jl/blob/6d1329054751744243576b61d91035a6840182d7/src/molecule/similarity.jl#L138-L166">source</a></section></article><h2 id="Sokal-Similarity"><a class="docs-heading-anchor" href="#Sokal-Similarity">Sokal Similarity</a><a id="Sokal-Similarity-1"></a><a class="docs-heading-anchor-permalink" href="#Sokal-Similarity" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MoleculeFlow.sokal_similarity" href="#MoleculeFlow.sokal_similarity"><code>MoleculeFlow.sokal_similarity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sokal_similarity(fp1::Vector{Bool}, fp2::Vector{Bool})
sokal_similarity(mol1::Molecule, mol2::Molecule; fingerprint_type=:morgan, kwargs...)</code></pre><p>Calculate the Sokal similarity coefficient between two molecules or fingerprints.</p><p>The Sokal similarity is defined as intersection / (2 × union - intersection). This metric gives less weight to shared features compared to Tanimoto similarity.</p><p><strong>Arguments</strong></p><ul><li><code>fp1</code>, <code>fp2</code>: Boolean vectors representing molecular fingerprints</li><li><code>mol1</code>, <code>mol2</code>: Molecule objects to compare</li><li><code>fingerprint_type</code>: Type of fingerprint to use (<code>:morgan</code>, <code>:rdk</code>, <code>:maccs</code>)</li><li><code>kwargs...</code>: Additional arguments passed to fingerprint generation functions</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Similarity score between 0.0 (no similarity) and 1.0 (identical)</li><li><code>missing</code>: If either molecule is invalid</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">mol1 = mol_from_smiles(&quot;CCO&quot;)
mol2 = mol_from_smiles(&quot;CCC&quot;)
similarity = sokal_similarity(mol1, mol2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MoleculeHub/MoleculeFlow.jl/blob/6d1329054751744243576b61d91035a6840182d7/src/molecule/similarity.jl#L202-L230">source</a></section></article><h2 id="Bulk-Similarity"><a class="docs-heading-anchor" href="#Bulk-Similarity">Bulk Similarity</a><a id="Bulk-Similarity-1"></a><a class="docs-heading-anchor-permalink" href="#Bulk-Similarity" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MoleculeFlow.bulk_similarity" href="#MoleculeFlow.bulk_similarity"><code>MoleculeFlow.bulk_similarity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bulk_similarity(query_mol::Molecule, target_mols::Vector{Molecule};
               similarity_function=tanimoto_similarity, fingerprint_type=:morgan, kwargs...)</code></pre><p>Calculate similarity between one query molecule and a vector of target molecules.</p><p>This function efficiently computes pairwise similarities between a single query molecule and multiple target molecules, useful for similarity searches and ranking.</p><p><strong>Arguments</strong></p><ul><li><code>query_mol</code>: The reference molecule to compare against</li><li><code>target_mols</code>: Vector of molecules to compare with the query</li><li><code>similarity_function</code>: Function to use for similarity calculation (default: <code>tanimoto_similarity</code>)</li><li><code>fingerprint_type</code>: Type of fingerprint to use (<code>:morgan</code>, <code>:rdk</code>, <code>:maccs</code>)</li><li><code>kwargs...</code>: Additional arguments passed to fingerprint generation functions</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Union{Float64,Missing}}</code>: Vector of similarity scores, <code>missing</code> for invalid molecules</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">query = mol_from_smiles(&quot;CCO&quot;)
targets = [mol_from_smiles(&quot;CCC&quot;), mol_from_smiles(&quot;CC&quot;), mol_from_smiles(&quot;CCCO&quot;)]
similarities = bulk_similarity(query, targets)
most_similar_idx = argmax(similarities)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MoleculeHub/MoleculeFlow.jl/blob/6d1329054751744243576b61d91035a6840182d7/src/molecule/similarity.jl#L265-L294">source</a></section></article><h2 id="Similarity-Matrix"><a class="docs-heading-anchor" href="#Similarity-Matrix">Similarity Matrix</a><a id="Similarity-Matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Similarity-Matrix" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MoleculeFlow.similarity_matrix" href="#MoleculeFlow.similarity_matrix"><code>MoleculeFlow.similarity_matrix</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">similarity_matrix(mols::Vector{Molecule};
                 similarity_function=tanimoto_similarity, fingerprint_type=:morgan, kwargs...)</code></pre><p>Compute a symmetric similarity matrix for a vector of molecules.</p><p>This function creates an n×n symmetric matrix where element (i,j) represents the similarity between molecules i and j. The diagonal elements are always 1.0 (self-similarity).</p><p><strong>Arguments</strong></p><ul><li><code>mols</code>: Vector of molecules to compare</li><li><code>similarity_function</code>: Function to use for similarity calculation (default: <code>tanimoto_similarity</code>)</li><li><code>fingerprint_type</code>: Type of fingerprint to use (<code>:morgan</code>, <code>:rdk</code>, <code>:maccs</code>)</li><li><code>kwargs...</code>: Additional arguments passed to fingerprint generation functions</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{Union{Float64,Missing}}</code>: Symmetric similarity matrix, <code>missing</code> for invalid molecules</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">mols = [mol_from_smiles(&quot;CCO&quot;), mol_from_smiles(&quot;CCC&quot;), mol_from_smiles(&quot;CCCO&quot;)]
sim_matrix = similarity_matrix(mols)
# Access similarity between molecules 1 and 3
sim_1_3 = sim_matrix[1, 3]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MoleculeHub/MoleculeFlow.jl/blob/6d1329054751744243576b61d91035a6840182d7/src/molecule/similarity.jl#L321-L349">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bonds/">« Bond Operations</a><a class="docs-footer-nextpage" href="../standardization/">Standardization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 27 September 2025 06:34">Saturday 27 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
