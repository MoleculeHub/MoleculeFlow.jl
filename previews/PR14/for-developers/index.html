<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>For Developers · MoleculeFlow.jl</title><meta name="title" content="For Developers · MoleculeFlow.jl"/><meta property="og:title" content="For Developers · MoleculeFlow.jl"/><meta property="twitter:title" content="For Developers · MoleculeFlow.jl"/><meta name="description" content="Documentation for MoleculeFlow.jl."/><meta property="og:description" content="Documentation for MoleculeFlow.jl."/><meta property="twitter:description" content="Documentation for MoleculeFlow.jl."/><meta property="og:url" content="https://moleculehub.github.io/MoleculeFlow.jl/for-developers/"/><meta property="twitter:url" content="https://moleculehub.github.io/MoleculeFlow.jl/for-developers/"/><link rel="canonical" href="https://moleculehub.github.io/MoleculeFlow.jl/for-developers/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="MoleculeFlow.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MoleculeFlow.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../examples/">Practical Examples</a></li><li class="is-active"><a class="tocitem" href>For Developers</a><ul class="internal"><li><a class="tocitem" href="#Architecture-Overview"><span>Architecture Overview</span></a></li><li><a class="tocitem" href="#Development-Pattern"><span>Development Pattern</span></a></li><li><a class="tocitem" href="#Critical-Index-Conversion"><span>Critical Index Conversion</span></a></li><li><a class="tocitem" href="#Error-Handling-Patterns"><span>Error Handling Patterns</span></a></li><li><a class="tocitem" href="#Contributing-New-Functions"><span>Contributing New Functions</span></a></li><li><a class="tocitem" href="#Best-Practices"><span>Best Practices</span></a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../api/io/">Basic I/O</a></li><li><a class="tocitem" href="../api/operations/">Molecular Operations</a></li><li><a class="tocitem" href="../api/reactions/">Chemical Reactions</a></li><li><a class="tocitem" href="../api/drawing/">Drawing &amp; Visualization</a></li><li><a class="tocitem" href="../api/descriptors/">Molecular Descriptors</a></li><li><a class="tocitem" href="../api/fingerprints/">Fingerprints</a></li><li><a class="tocitem" href="../api/pharmacophore/">Pharmacophore Features</a></li><li><a class="tocitem" href="../api/substructure/">Substructure Search</a></li><li><a class="tocitem" href="../api/atoms/">Atom Operations</a></li><li><a class="tocitem" href="../api/bonds/">Bond Operations</a></li><li><a class="tocitem" href="../api/similarity/">Similarity</a></li><li><a class="tocitem" href="../api/standardization/">Standardization</a></li><li><a class="tocitem" href="../api/conformers/">Conformers</a></li><li><a class="tocitem" href="../api/alignment/">Alignment</a></li><li><a class="tocitem" href="../api/fragmentation/">Fragmentation</a></li><li><a class="tocitem" href="../api/graph/">Graph Operations</a></li><li><a class="tocitem" href="../api/progress/">Progress Tracking</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>For Developers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>For Developers</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MoleculeHub/MoleculeFlow.jl/blob/main/docs/src/for-developers.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="For-Developers"><a class="docs-heading-anchor" href="#For-Developers">For Developers</a><a id="For-Developers-1"></a><a class="docs-heading-anchor-permalink" href="#For-Developers" title="Permalink"></a></h1><h2 id="Architecture-Overview"><a class="docs-heading-anchor" href="#Architecture-Overview">Architecture Overview</a><a id="Architecture-Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Architecture-Overview" title="Permalink"></a></h2><p>MoleculeFlow.jl is built as a Julia wrapper around  <a href="https://github.com/rdkit/rdkit">RDKit</a> cheminformatics library.  Rather than reimplementing complex cheminformatics algorithms from scratch, we leverage RDKit&#39;s mature and battle-tested implementations while providing a clean, Julia-native interface, which also allows to build additional functionality on top.</p><div class="admonition is-info" id="Info-70727691938e1e45"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-70727691938e1e45" title="Permalink"></a></header><div class="admonition-body"><p>Knowledge of Python RDKit is assumed. This background knowledge is essential because MoleculeFlow&#39;s functions are direct mappings to RDKit functionality.</p></div></div><h2 id="Development-Pattern"><a class="docs-heading-anchor" href="#Development-Pattern">Development Pattern</a><a id="Development-Pattern-1"></a><a class="docs-heading-anchor-permalink" href="#Development-Pattern" title="Permalink"></a></h2><h3 id="1.-Low-Level-Caching-Layer"><a class="docs-heading-anchor" href="#1.-Low-Level-Caching-Layer">1. Low-Level Caching Layer</a><a id="1.-Low-Level-Caching-Layer-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Low-Level-Caching-Layer" title="Permalink"></a></h3><p>All RDKit functionality is accessed through caching functions in <code>src/rdkit.jl</code>. This file contains functions that:</p><ul><li>Import and cache Python RDKit modules and functions using <code>@pyconst</code></li><li>Provide direct access to RDKit functions</li><li>Handle the Python-Julia interface via PythonCall.jl</li></ul><div class="admonition is-info" id="Info-ea74763d02f3036"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-ea74763d02f3036" title="Permalink"></a></header><div class="admonition-body"><p>The <code>@pyconst</code> macro from PythonCall.jl is used to cache Python function calls for better performance. This ensures that the Python import and function lookup only happens once, and subsequent calls reuse the cached function object.</p></div></div><p>Example from <code>rdkit.jl</code>:</p><pre><code class="language-julia hljs"># RDKit function caching with @pyconst
_mol_from_smiles(smiles::String) = @pyconst(pyimport(&quot;rdkit.Chem&quot;).MolFromSmiles)(smiles)
_mol_to_smiles(mol::Py) = @pyconst(pyimport(&quot;rdkit.Chem&quot;).MolToSmiles)(mol)

function _mol_wt(mol::Py)
    @pyconst(pyimport(&quot;rdkit.Chem.Descriptors&quot;).MolWt)(mol)
end

function _heavy_atom_count(mol::Py)
    @pyconst(pyimport(&quot;rdkit.Chem.Descriptors&quot;).HeavyAtomCount)(mol)
end</code></pre><h3 id="2.-Higher-Level-Julia-Wrappers"><a class="docs-heading-anchor" href="#2.-Higher-Level-Julia-Wrappers">2. Higher-Level Julia Wrappers</a><a id="2.-Higher-Level-Julia-Wrappers-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Higher-Level-Julia-Wrappers" title="Permalink"></a></h3><p>The main API functions are implemented as Julia wrappers around the cached RDKit functions. </p><p>Example wrapper pattern:</p><pre><code class="language-julia hljs">function molecular_weight(mol::Molecule)
    !mol.valid &amp;&amp; return missing

    try
        result = _mol_wt(mol._rdkit_mol)
        return pyconvert(Float64, result)
    catch
        return missing
    end
end

function get_atom(mol::Molecule, idx::Int)
    !mol.valid &amp;&amp; throw(ArgumentError(&quot;Invalid molecule&quot;))

    # Convert indices (Julia 1-based → Python 0-based)
    python_idx = idx - 1

    rdkit_atom = mol._rdkit_mol.GetAtomWithIdx(python_idx)
    return Atom(rdkit_atom, mol)
end</code></pre><h2 id="Critical-Index-Conversion"><a class="docs-heading-anchor" href="#Critical-Index-Conversion">Critical Index Conversion</a><a id="Critical-Index-Conversion-1"></a><a class="docs-heading-anchor-permalink" href="#Critical-Index-Conversion" title="Permalink"></a></h2><div class="admonition is-danger" id="Danger-f3211ed4786cf201"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-f3211ed4786cf201" title="Permalink"></a></header><div class="admonition-body"><p>Index Conversion is Critical: Julia uses 1-based indexing while Python uses 0-based indexing. </p></div></div><h3 id="Examples-of-Index-Handling"><a class="docs-heading-anchor" href="#Examples-of-Index-Handling">Examples of Index Handling</a><a id="Examples-of-Index-Handling-1"></a><a class="docs-heading-anchor-permalink" href="#Examples-of-Index-Handling" title="Permalink"></a></h3><pre><code class="language-julia hljs">
function get_atom(mol::Molecule, idx::Int)
    rdkit_mol = mol._rdkit_mol
    rdkit_idx = idx - 1  
    return get_chem().GetAtomWithIdx(rdkit_mol, rdkit_idx)
end</code></pre><h2 id="Error-Handling-Patterns"><a class="docs-heading-anchor" href="#Error-Handling-Patterns">Error Handling Patterns</a><a id="Error-Handling-Patterns-1"></a><a class="docs-heading-anchor-permalink" href="#Error-Handling-Patterns" title="Permalink"></a></h2><h3 id="Molecule-Validation"><a class="docs-heading-anchor" href="#Molecule-Validation">Molecule Validation</a><a id="Molecule-Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Molecule-Validation" title="Permalink"></a></h3><p>Always check molecule validity:</p><pre><code class="language-julia hljs">function some_function(mol::Molecule)
    !mol.valid &amp;&amp; throw(ArgumentError(&quot;Invalid molecule&quot;))
    # ... proceed with function
end</code></pre><h3 id="Graceful-Degradation"><a class="docs-heading-anchor" href="#Graceful-Degradation">Graceful Degradation</a><a id="Graceful-Degradation-1"></a><a class="docs-heading-anchor-permalink" href="#Graceful-Degradation" title="Permalink"></a></h3><p>For operations that may fail, return appropriate fallback values:</p><pre><code class="language-julia hljs">function calculate_descriptor(mol::Molecule)
    !mol.valid &amp;&amp; return missing

    try
        result = rdkit_calculation(mol._rdkit_mol)
        return convert_result(result)
    catch
        return missing  # Or appropriate fallback
    end
end</code></pre><h2 id="Contributing-New-Functions"><a class="docs-heading-anchor" href="#Contributing-New-Functions">Contributing New Functions</a><a id="Contributing-New-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Contributing-New-Functions" title="Permalink"></a></h2><p>When adding new functionality:</p><ol><li><strong>Add RDKit module caching</strong> to <code>src/rdkit.jl</code> if needed</li><li><strong>Implement the wrapper</strong> in the appropriate module file</li><li><strong>Export the function</strong> in <code>src/MoleculeFlow.jl</code></li><li><strong>Add comprehensive tests</strong> following existing patterns</li><li><strong>Document with examples</strong> in the appropriate API docs file</li><li><strong>Handle index conversion</strong> carefully</li><li><strong>Follow existing error handling patterns</strong></li></ol><h2 id="Best-Practices"><a class="docs-heading-anchor" href="#Best-Practices">Best Practices</a><a id="Best-Practices-1"></a><a class="docs-heading-anchor-permalink" href="#Best-Practices" title="Permalink"></a></h2><ol><li><strong>Follow existing naming conventions</strong> (snake_case for functions)</li><li><strong>Use keyword arguments</strong> for optional parameters</li><li><strong>Provide sensible defaults</strong> where possible</li><li><strong>Handle missing/invalid inputs gracefully</strong></li><li><strong>Add type annotations</strong> where helpful</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Practical Examples</a><a class="docs-footer-nextpage" href="../api/io/">Basic I/O »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 27 September 2025 05:23">Saturday 27 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
